// Generated by CoffeeScript 1.6.3
(function() {
  var GeolocationService, libr;

  libr = angular.module('libr.services.geolocation', []);

  GeolocationService = (function() {
    var onError, onSuccess;

    GeolocationService.$inject = ['$http'];

    function GeolocationService($http) {
      this.$http = $http;
    }

    onSuccess = function(position) {
      alert('lat' + position.coords.latitude);
      return {
        "Latitude": position.coords.latitude,
        "Longitude": position.coords.longitude,
        "Altitude": position.coords.altitude,
        "Accuracy": position.coords.accuracy,
        "Altitude Accuracy": position.coords.altitudeAccuracy,
        "Heading": position.coords.heading,
        "Speed": position.coords.speed,
        "Timestamp": position.timestamp
      };
    };

    onError = function(error) {
      throw "code:  " + error.code + " \n message: " + error.message;
    };

    GeolocationService.prototype.getCurrentLocation = function(callback, error) {
      return navigator.geolocation.getCurrentPosition(callback, error);
    };

    GeolocationService.prototype.getDetailAddress = function(callback, error) {
      var baseUrl,
        _this = this;
      baseUrl = 'http://libr.herokuapp.com/api/v1/locations/detail';
      return this.getCurrentLocation(function(position) {
        return _this.$http.get("" + baseUrl + "?lat=" + position.coords.latitude + "&lng=" + position.coords.longitude).success(function(data, status, headers, config) {
          return callback(data);
        });
      }, function(error) {
        throw Error(error);
      });
    };

    GeolocationService.prototype.getLocations = function(callback, error) {
      var baseUrl, email, token;
      baseUrl = 'http://libr.herokuapp.com/api/v1/locations';
      email = localStorage.getItem('email');
      token = localStorage.getItem('token');
      return this.$http.get("" + baseUrl + "?user_email=" + email + "&user_token=" + token).success(function(data, status, headers, config) {
        return callback(data);
      }).error(function(data) {
        throw Error(error);
      });
    };

    return GeolocationService;

  })();

  libr.service('GeolocationService', GeolocationService);

}).call(this);
