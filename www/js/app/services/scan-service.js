// Generated by CoffeeScript 1.7.1
(function() {
  var ScanService, libr;

  libr = angular.module('libr.services.scan', []);

  ScanService = (function() {
    ScanService.$inject = ['Books'];

    function ScanService(Books) {
      this.Books = Books;
    }

    ScanService.prototype.scan = function() {
      return setTimeout((function(_this) {
        return function() {
          return cordova.plugins.barcodeScanner.scan(function(result) {
            return _this.Books.save({
              isbn: result.text
            }, null, function(data) {
              if (data.status === 'error') {
                return alert('不能找到该书');
              } else {
                return alert('添加图书成功');
              }
            }, function(error) {
              return alert('添加图书失败');
            });
          }, function(error) {
            return alert("Scanning failed:" + error + " ");
          });
        };
      })(this), 700);
    };

    ScanService.prototype.save = function() {
      return this.Books.save({
        isbn: '9787550221116'
      }, null, function(result) {
        if (result.status === 'error') {
          return alert('不能找到该书');
        } else {
          return alert('添加图书成功');
        }
      });
    };

    return ScanService;

  })();

  libr.service('ScanService', ScanService);

}).call(this);
